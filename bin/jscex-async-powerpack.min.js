(function(){var j=function(d){if(!d.modules||!d.modules["async-powerpack"]){if(!d.modules||!d.modules.async)throw Error('Missing essential component, please initialize "jscex-async" module first.');var e=d.Async,i=e.Task,j=e.CanceledError;e.sleep=function(c,b){return new i({onStart:function(f){b&&b.throwIfCancellationRequested();var g,a;b&&(a=function(){clearTimeout(g);f("failure",new j)});g=setTimeout(function(){b&&b.unregister(a);f("success")},c);b&&b.register(a)}})};e.onEvent=function(c,b){var f=
"on"+b;return new i({onStart:function(b){c[f]=function(a){c[f]=null;b("success",a)}}})};i.waitAll=function(c){return new i({onStart:function(b){for(var f={},g=[],a=0;a<c.length;a++)f[c[a].id]=a,g.push(h);var d=[],e=function(a){if(a.error){for(var c=0;c<tasksClone.length;c++)g[c].removeListener(e);b("failure",a.error)}else d[f[a.id]]=a.result,a=tasksClone.indexOf(a),g.splice(a,1),g.length==0&&(finished=!0,b("success",d))};for(a=0;a<c.length;a++){var h=c[a];switch(h.status){case "ready":h.addListener(e);
h.start();break;case "running":h.addListener(e);break;default:e(h)}}}})};d.modules["async-powerpack"]=!0}};typeof require!=="undefined"&&typeof module!=="undefined"&&module.exports?module.exports.init=j:j(Jscex)})();
