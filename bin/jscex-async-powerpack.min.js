(function(){var l=function(d){this.children=[];if(d)for(var a=0;a<d.length;a++)this.children.push(d[a])};l.prototype={_typeId:"4a73efb8-c2e2-4305-a05c-72385288650a",message:"This is an error contains sub-errors, please check the 'children' collection for more details.",isTypeOf:function(d){return d._typeId=="4a73efb8-c2e2-4305-a05c-72385288650a"}};var n=function(d){if(d.length<=1)return null;for(var a=[],c=1;c<d.length;c++)a.push(d[c]);return a},o=function(d,a){for(var c=[],i=0;i<d.length;i++)c.push(d[i]);
for(;c.length<a;)c.push(void 0);return c},k=function(d){if(!d.modules["async-powerpack"]){if(!d.modules.async)throw Error('Missing essential components, please initialize "jscex-async" module first.');var a=d.Async,c=a.Task,i=a.CanceledError;a.AggregateError=l;a.sleep=function(g,b){return c.create(function(c){b&&b.isCancellationRequested&&c.complete("failure",new i);var e,h;b&&(h=function(){clearTimeout(e);c.complete("failure",new i)});e=setTimeout(function(){b&&b.unregister(h);c.complete("success")},
g);b&&b.register(h)})};a.onEvent=function(g,b,a){return c.create(function(e){a&&a.isCancellationRequested&&e.complete("failure",new i);var h=function(){g.removeEventListener?g.removeEventListener(b,f):g.removeListener?g.removeListener(b,f):g.detachEvent(b,f)},f,c;a&&(c=function(){h();e.complete("failure",new i)});f=function(b){a&&a.unregister(c);h();e.complete("success",b)};g.addEventListener?g.addEventListener(b,f):g.addListener?g.addListener(b,f):g.attachEvent(b,f);a&&a.register(c)})};c.whenAll=
function(){var g;if(arguments.length==1){var b=arguments[0];g=c.isTask(b)?[b]:b}else{g=Array(arguments.length);for(b=0;b<arguments.length;b++)g[b]=arguments[b]}return c.create(function(b){var e={},a;for(a in g)if(g.hasOwnProperty(a)){var f=g[a];f&&(c.isTask(f)||(g[a]=f=c.whenAll(f)),e[f.id]=a)}for(var d in e)e.hasOwnProperty(d)&&(f=g[e[d]],f.status=="ready"&&f.start());var j=function(){var f=Object.prototype.toString.call(g)==="[object Array]"?Array(g.length):{},a=[],c;for(c in e)if(e.hasOwnProperty(c)){var d=
e[c],h=g[d];h.error?a.push(h.error):f[d]=h.result}a.length>0?b.complete("failure",new l(a)):b.complete("success",f)},m=0;for(d in e)e.hasOwnProperty(d)&&(a=e[d],f=g[a],f.status=="running"&&(m++,f.addEventListener("complete",function(){--m==0&&j()})));m==0&&j()})};c.whenAny=function(){var a={};if(arguments.length==1){var b=arguments[0];c.isTask(b)?a[0]=b:a=b}else for(b=0;b<arguments.length;b++)a[b]=arguments[b];return c.create(function(b){var e={},h;for(h in a)if(a.hasOwnProperty(h)){var f=a[h];c.isTask(f)&&
(e[f.id]=h)}for(var d in e)f=a[e[d]],f.status=="ready"&&f.start();for(d in e)if(h=e[d],f=a[h],f.error||f.status=="succeeded"){b.complete("success",{key:h,task:f});return}var j=function(){for(var f in e)a[e[f]].removeEventListener("complete",j);b.complete("success",{key:e[this.id],task:this})};for(d in e)a[e[d]].addEventListener("complete",j)})};c.prototype.then=c.prototype.continueWith=function(a){var b=this;return c.create(function(c){var e=function(){this.error?c.complete("failure",this.error):
c.complete("success",this.result)},d=function(){if(this.error)return c.complete("failure",this.error);var b;try{b=a(this.result)}catch(d){return c.complete("failure",d)}b.status=="ready"&&b.start();b.status=="running"?b.addEventListener("complete",e):e.call(b)};b.status=="ready"&&b.start();b.status=="running"?b.addEventListener("complete",d):d.call(b)})};if(!a.Binding)a.Binding={};if(!a.Jscexify)a.Jscexify={};a=a.Jscexify=a.Binding;a.fromStandard=function(a){var b=n(arguments);return function(){var d=
this,e=o(arguments,a.length-1);return c.create(function(c){e.push(function(a,d){if(a)c.complete("failure",a);else if(b){for(var e={},g=0;g<b.length;g++)e[b[g]]=arguments[g+1];return c.complete("success",e)}else c.complete("success",d)});a.apply(d,e)})}};a.fromCallback=function(a){var b=n(arguments);return function(){var d=this,e=o(arguments,a.length-1);return c.create(function(c){e.push(function(a){if(b){for(var d={},e=0;e<b.length;e++)d[b[e]]=arguments[e];c.complete("success",d)}else c.complete("success",
a)});a.apply(d,e)})}};d.modules["async-powerpack"]=!0}},p=typeof define==="function"&&!define.amd,q=typeof require==="function"&&typeof define==="function"&&define.amd;if(typeof require==="function"&&typeof module!=="undefined"&&module.exports)module.exports.init=k;else if(p)define("jscex-async-powerpack",["jscex-async"],function(d,a,c){c.exports.init=k});else if(q)define("jscex-async-powerpack",["jscex-async"],function(){return{init:k}});else{if(typeof Jscex==="undefined")throw Error('Missing the root object, please load "jscex" module first.');
k(Jscex)}})();
