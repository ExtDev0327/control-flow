(function(){var k=function(e){if(!e.modules||!e.modules["async-powerpack"]){if(!e.modules||!e.modules.async)throw Error('Missing essential component, please initialize "jscex-async" module first.');var g=e.Async,i=g.Task,j=g.CanceledError;g.sleep=function(b,c){return i.create(function(d){c&&c.isCancellationRequested&&d.complete("failure",new j);var f,a;c&&(a=function(){clearTimeout(f);d.complete("failure",new j)});f=setTimeout(function(){c&&c.unregister(a);d.complete("success")},b);c&&c.register(a)})};
g.onEvent=function(b,c,d){return i.create(function(f){d&&d.isCancellationRequested&&f.complete("failure",new j);var a,e;d&&(e=function(){b.removeEventListener?b.removeEventListener(c,a):b.detachEvent(c,a);f.complete("failure",new j)});a=function(a){d&&d.unregister(e);f.complete("success",a)};b.addEventListener?b.addEventListener(c,a):b.attachEvent(c,a);d&&d.register(e)})};i.whenAll=function(b){Object.prototype.toString.call(b)!=="[object Array]"&&(b=arguments);return i.create(function(c){for(var d=
{},f=[],a=0;a<b.length;a++)d[b[a].id]=a,f.push(h);var e=[],g=function(a){if(a.error){for(var b=0;b<tasksClone.length;b++)f[b].removeListener(g);c.complete("failure",a.error)}else e[d[a.id]]=a.result,a=f.indexOf(a),f.splice(a,1),f.length==0&&(finished=!0,c.complete("success",e))};for(a=0;a<b.length;a++){var h=b[a];switch(h.status){case "ready":h.addEventListener("complete",g);h.start();break;case "running":h.addEventListener("complete",g);break;default:g(h)}}})};e.modules["async-powerpack"]=!0}};typeof require!==
"undefined"&&typeof module!=="undefined"&&module.exports?module.exports.init=k:k(Jscex)})();
