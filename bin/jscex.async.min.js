typeof Jscex=="undefined"&&(Jscex={builders:{}});Jscex.Async={};Jscex.Async.Task=function(a){this.c=a;this.status="ready"};
Jscex.Async.Task.prototype={start:function(a){if(this.status!="ready")throw new "Cannot start in current status";var b=this;a&&a.onSuccess&&this.attachEvent("success",a.onSuccess);a&&a.onFailure&&this.attachEvent("failure",a.onFailure);a&&a.onComplete&&this.attachEvent("complete",a.onComplete);this.status="running";this.c.start(function(c,d){if(c=="success")b.result=d,b.status="succeeded",b.b("success");else if(c=="failure")b.error=d,b.status="failed",b.b("failure");else throw"Unsupported type: "+
c;b.b("complete");this.a=null})},b:function(a){if(a=this.a&&this.a[a])for(var b=0;b<a.length;b++)try{a[b](this)}catch(c){}},attachEvent:function(a,b){if(this.status!="ready"&&this.status!="running")throw"Cannot attach handler in current status.";if(!this.a)this.a={};this.a[a]||(this.a[a]=[]);this.a[a].push(b)}};
(function(){Jscex.builders.async={binder:"$await",Start:function(b,c){return new Jscex.Async.Task({start:function(d){c.start(b,function(b,c){if(b=="normal"||b=="return")d("success",c);else if(b=="throw")d("error",c);else throw"Unsupported type: "+b;})}})},Bind:function(b,c){return{start:function(d,a){function e(e){if(e.status=="succeeded"){var f;try{f=c.call(d,b.result)}catch(h){a("throw",h);return}f.start(d,a)}else a("throw",b.error)}b.status=="ready"?b.start({onComplete:e}):b.status=="running"?
b.attachEvent("complete",e):e(b)}}},Loop:function(b,c,d,a){return{start:function(e,i){function f(d){try{c&&!d&&c.call(e),!b||b.call(e)?h(!1):i("normal")}catch(a){i("throw",a)}}function h(b){d.start(e,function(c,d){if(c=="normal"||c=="continue")f(b);else if(c=="throw"||c=="return")i(c,d);else if(c=="break")i("normal");else throw'Invalid type for "Loop": '+c;})}a?h(!0):f(!0)}}},Delay:function(b){return{start:function(c,d){try{b.call(c).start(c,d)}catch(a){d("throw",a)}}}},Combine:function(b,c){return{start:function(d,
a){b.start(d,function(b,i,f){if(b=="normal")try{c.start(d,a)}catch(h){a("throw",h)}else a(b,i,f)})}}},Return:function(b){return{start:function(c,a){a("return",b)}}},Normal:function(){return{start:function(b,c){c("normal")}}},Break:function(){return{start:function(b,c){c("break")}}},Continue:function(){return{start:function(b,c){c("continue")}}},Throw:function(b){return{start:function(c,a){a("throw",b)}}},Try:function(b,c,a){return{start:function(g,e){b.start(g,function(b,f,h){if(b!="throw"||!c)a?
a.start(g,function(a,c,d){a=="normal"?e(b,f,h):e(a,c,d)}):e(b,f,h);else if(c){var j;try{j=c.call(g,f)}catch(k){a?a.start(g,function(b,a,c){b=="normal"?e("throw",k):e(b,a,c)}):e("throw",k)}j&&j.start(g,function(b,c,f){b=="throw"?a?a.start(g,function(a,d,g){a=="normal"?e(b,c,f):e(a,d,g)}):e(b,c,f):a?a.start(g,function(a,d,g){a=="normal"?e(b,c,f):e(a,d,g)}):e(b,c,f)})}else a.start(g,function(a,c,d){a=="normal"?e(b,f,h):e(a,c,d)})})}}}};var a=Jscex.Async;a.sleep=function(b){return new Jscex.Async.Task({start:function(a){setTimeout(function(){a("success")},
b)}})};a.onEvent=function(b,a){return new Jscex.Async.Task({start:function(d){var g="on"+a;b[g]=function(a){b[g]=null;d("success",a)}}})}})();
